from gmpy2 import *
from secret import FLAG
from Crypto.Util.number import getPrime, bytes_to_long

ns = [getPrime(1024) * getPrime(1024) for _ in range(3)]
cs = [pow(E2, 89, n) for n in ns]
# print(f'ns = {ns}')
# print(f'cs = {cs}')
# ns = [10140530976783792047036517694399388895014637002891351627957177080950715343369050838719778431752729430235643998023339276001811769859540578532651709355526544996067451344563754573108665811321186634190387509933067218085581080661014891625402641157281186919279929015675777750140660018946488702206092824921038262945389456115552895790859635004624137509068888496916822096067158869205529695626154436241269015251598578010509343214342106418083454242645700469305363277957446549528364669054897802293773514909017428978370386452328559985324458282988130484372250426640397641583898795650353449555168931512743056149797056418950382985301, 20682704839176401244812173985962244426777574823057361856661926241317217530392536033504860373055972027375082156894772480196100066633299173886121248225138459702061891948379673094062282956265933349633933801801420018099677333932082890105434132471582039061918406578872851136607321519139139028621228443764700155347780384671864911556110753526448107901571145351897069079187493705699688108597973878916861479606398875047151942913917269861627279617698226431975667262062567615967358950177755727274894973223470880171435070728316312770746664647167669649810180803639590251829404231567469105182416268011389226764529650955186167485373, 20626611549325492213354776582595738255855322134816102058028951762154036528692975690645014190267315489478187254092651228439866434067956232232999146430017794681014216227006808773754297800117529215017988066419939205520573300936032109170728009634223112453100520061321037362113361836141103283475959044480054223326208287276267023758162320007949854731356537888901331504980045758829165139237679399833651743499574498084604579301581645007713413529741392465376237147310747066518808695202152585029346895154748275251830773078457130030003686000695204365240743589135757046691777498922627832748112142386851972879551842491375944519587]
# cs = [9236538509909702650652978898032510155377597668210443244161266596362798887119965853310153939601277435858750704127318409082072307987428982952782325728536885487208865922620613540694575512320985329376722339057353111462882637162792723709843135063440735788886918054655604583307473276840691243151766580730253361231041111617865902785671636752865383878277213339032943813673864487545257710929110601560221152147171186038948080985206887455496323820202300922943645768892582637717142478036629353305768768791491720342052613868059365889204575478550479513798929274538835887417685252408305714456701196335700352411884144992008515859751, 4328925164888537060970330905548310497830884036754148249900920998017072107025092315429402761194265354000790378267375227305880886117353174356136226421376637214771600468457019515622045926723435900690057476642100511489386223737878787190485932651849904396299070722562395430808901584903195098791601236783678905163222440132387085858226954291394054912889661236038206629426461484653282089121214095346777944395503092578400954348881481093185165747898782411502214814042585562510851001520449758213591944756497363336880443883085272896838884052701352094892088875943405879718584883442433818216778089080040416970901597908980255003888, 14313342778953953081339700327572280774141525305527326287272965991834935935570141474268498959268341031142265098756883556136553493978542511536466146925504161078092274108652221882135792829382944384899945867978042366920074100736520635698491924618517322866137925768091772544086459415597634060549161569344931157764960164498110509271062640213710240851147673015792308271196673289448412650426050019488702524005204195843305860996391796754142857384135672022479515855345884881792260698401434511412869323625677008347194729294112521793026999027815953310366823809178991246348064521621014813115409267153628397749883028838392641095906]

p = getPrime(1024)
q = getPrime(1024)
n = p * q
e1 = getPrime(32)
e2 = getPrime(32)
c1 = pow(E1, e1, n)
c2 = pow(E1, e2, n)
print(f'n = {n}')
print(f'e1 = {e1}')
print(f'e2 = {e2}')
print(f'c1 = {c1}')
print(f'c2 = {c2}')
# n = 29565543709031592139972871406419057350065671103025293225749386258526476264815727635410675159582275142380076143093458780209472831424099771756482890087161249249813450575381642821618902163289286060241403569488941617825814537127677917383314512041173104626172244677365567322281176126320017945240413047486987921618807840258404506462106321250935448162453085317044756369243957001908676934276859961697339250994574662782617374583922682178915249443115749450654878460000912680766063368380784206766029487439089379282135022110223075130530124872310670522517923290572119865041175570299105947394022191383556123254678481810228856253069
# e1 = 2978655959
# e2 = 3603913457
# c1 = 13558087627332404217343700480261975943505358145490195564751172402420615990784674018809470616471389197591735508675003432994211162730769503766120605181758351186510075284521387413673688152698899452829437031870389381691963501451237656355352587423425275376644249801977915975755905510374052549875830179722735109188580220709857855215321806924751521599699446213850617549794552566229456321883948573607804641701332494345927168028802322435434919692280647374444194712385092127124265574814680129504252978103657578830871042620925325767016826752015762713364390388838003215103165930714142608113192660474881911923703453513753570585786
# c2 = 26505078993665159588671802054109926548196885117048019774362592438006658159736166393368457208945964596563859871595996905322106076461436066723267994173913471104400482522076525299851815706619220372853538871931508381070196820532863709694570928672088500924102105517731904074056562566257404593502338730114603859820481136850792607640497611512446323698926088880414563036770035311369504976305854496448454677388472012441302132581349454184644202335944028121487685929945899848372109647435959277137274878799367553652936185921698118732702133575033649564280511051440927454001461433452590809369419971908332944776909527000495119412116



P=getPrime(1024)
Q1=getPrime(1024)
Q2=getPrime(1024)
n1 = P * Q1
n2 = P * Q2
c3 = pow(FLAG, E1, n1)
c4 = pow(FLAG, E2, n2)
print(f'n1 = {n1}')
print(f'n2 = {n2}')
print(f'c3 = {c3}')
print(f'c4 = {c4}')
# n1 = 19989816227670966515396950489791996794310690299825905579114799198807300643991179672664754149444021628569903569058805400750469535364503000856265774774327167175486657236118274348121316343690392997352422322979848454448623930315734062368160895220586486019961512756750118678240534860940588822066389065456026893330471129776166331225627529101613299181201344088757046065428188582263196679222393751146672680558894887347732269214020945270700041246133369658597606801193883497772144912619258342234864863007380427362048485525922245001335548195221758061058908901977274305052463555294003183324103411616037091567244834737606473753553
# n2 = 16792510778541603579719683512193381542436682649833222420661513722611485760889074720285109629175500731941413849008285667315685840494997624683127984014352901184181783110916353445491345585881713357287935246703441344566824079508599012325379299928199456712685734321846578955041005601894521048098083105708269300758431147481934681228511594639177608157540638267329475550729893534733285910111990733900581104134686502668464024356541918709154810942093697683466231252667697392370762461283345783830287579098638542096713555239958741201834874060456985793942910440975577560329432140927949404873811693904595763398512200684776917348691
# c3 = 12743343009900280032153997656184867078660651750100989783596036911118381000072322376257595883064434436336216179768440362699514241267358484538125346561810696921871200199156008604083131761562338613524217226904888117929055133089446844792151920135395686551080189439837612976880100765198490069509436409132241839573666343087497021948744259707623485876625327555266912501882054735021420926347961864494449371873998968473555011672569401179006995536925954076545298624649243066721871439746431959770087314606913895521685512632086255823949509763105403701641911908791790152709046842728192790059015700332445599282446450450168967498109
# c4 = 4325089982421639034332772360635397085573070809409753684559044765558185813987064054784042282902940685604759294357316181528888908640347857150311198760851563211850240649023911599652948226606768425918095514563343665985509272725462337230163273935017539907818094564893138221164587333074105374334353893495599663192290217413432355024736204856620772989739085337466350182557169353438248272903070168358043479483139043668224398811940608519513012200125484901722856386643167709797325096074225136289013176579881952616340595035655230623173851706942308711008650636807514686195892761425489893349210884312192129950182288107471594165515
